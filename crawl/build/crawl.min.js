"use strict";function _typeof(e){return(_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}(function(){var e,c,s,p,u;c=require("request"),s=require("stopword"),p={limit:1e3,lang:"en"},u=function(e){var i,t;return t={boolean:{},number:{},string:{}},i=[],e.filter(function(e){var n;return(n=_typeof(e))in t?!t[n].hasOwnProperty(e)&&(t[n][e]=!0):!(0<=i.indexOf(e))&&i.push(e)})},e={retrieve:function(e,i){var t,r,o,a,l,n;if(Object.assign(p,e),!(p.name&&p.properties&&p.lang))return[];l="PREFIX wdt: <http://www.wikidata.org/prop/direct/>\nPREFIX rdfs: <http://www.w3.org/2000/01/rdf-schema#>\n\nSELECT DISTINCT ?item ?label ?description ",o="\n  OPTIONAL{ ?item <http://schema.org/description> ?description . }",r='\n  SERVICE wikibase:label {\n    bd:serviceParam wikibase:language "[AUTO_LANGUAGE],'.concat(p.lang,'".\n    ?Pdescription rdfs:label ?description . '),t="\nGROUP BY ?item ?label ?description ",p.properties.forEach(function(e,n){!0===e.concat||!0===e.stopword?l+="(GROUP_CONCAT(DISTINCT ?"+e.label+'; SEPARATOR=", ") AS ?'+e.label+") ":(l+="?".concat(e.label," "),t+="?".concat(e.label," ")),o+="\n  OPTIONAL{ ?item wdt:".concat(e.name," ?P").concat(e.label," . }"),r+="\n    ?P".concat(e.label," rdfs:label ?").concat(e.label," . ")}),r+="\n    ?item rdfs:label ?label . ",r+="\n  } ",n='WHERE {\n  SERVICE wikibase:mwapi {\n    bd:serviceParam wikibase:api "EntitySearch" .\n    bd:serviceParam wikibase:endpoint "www.wikidata.org" .\n    bd:serviceParam mwapi:search "'.concat(p.name,'" .\n    bd:serviceParam mwapi:language "').concat(p.lang,'" .\n    ?item wikibase:apiOutputItem mwapi:item .\n    ?num wikibase:apiOrdinal true .\n  }\n  ?item wdt:P31 wd:Q5. '),a=l+n+o+'\n  FILTER(LANG(?description) = "'+p.lang+'") '+r+"\n}"+t+"\nLIMIT "+p.limit,c("https://query.wikidata.org/sparql?query="+encodeURIComponent(a),{json:!0,headers:{"User-Agent":"request"}},function(e,n,t){if(e)return console.log(e);p.properties.forEach(function(i,e){if(!0===i.stopword)return t.results.bindings.forEach(function(e){var n;if(e[i.label].value)return n=s.removeStopwords(e[i.label].value.match(/\b(\S+)\b/g),s[p.lang]),!0===i.unique&&(n=u(n)),i.delimiter&&(n=n.join(i.delimiter)),e[i.label].value=n})}),!0===p.description.stopword&&t.results.bindings.forEach(function(e){var n;if(e.description.value)return n=s.removeStopwords(e.description.value.match(/\b(\S+)\b/g),s[p.lang]),!0===p.description.unique&&(n=u(n)),p.description.delimiter&&(n=n.join(p.description.delimiter)),e.description.value=n}),i({query:a,body:t})})}},module.exports=e}).call(void 0);
//# sourceMappingURL=crawl.js.map