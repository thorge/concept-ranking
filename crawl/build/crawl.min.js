"use strict";function _typeof(e){return(_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}(function(){var e,d,i;d=require("request"),i=require("stopword"),e=function(){var e,c,n,u,b,t,p;if(c={limit:1e3,lang:"en",endpoint:"https://query.wikidata.org/sparql?query="},u=function(e){var n,t;for(n in t=[],e)"item"!==n&&"label"!==n&&""!==e[n].value&&("object"===_typeof(e[n].value)?t=t.concat(e[n].value):t.push(e[n].value));return t},p=function(e){var t,i;return i={boolean:{},number:{},string:{}},t=[],e.filter(function(e){var n;return(n=_typeof(e))in i?!i[n].hasOwnProperty(e)&&(i[n][e]=!0):!(0<=t.indexOf(e))&&t.push(e)})},b=function(e,t){return e.forEach(function(e){var n;if(e[t.label].value)return n=i.removeStopwords(e[t.label].value.match(/\b(\S+)\b/g),i[c.lang]),!0===t.unique&&(n=p(n)),t.concat&&(n=n.join(t.delimiter)),e[t.label].value=n})},t=function(e,a){var i,r,o,l,s,n;if(Object.assign(c,e),!(c.name&&c.properties&&c.lang))return[];s="PREFIX wdt: <http://www.wikidata.org/prop/direct/>\nPREFIX rdfs: <http://www.w3.org/2000/01/rdf-schema#>\n\nSELECT DISTINCT ?item ?label ?description ",o="\n  OPTIONAL{ ?item <http://schema.org/description> ?".concat(c.description.label," . }"),r='\n  SERVICE wikibase:label {\n    bd:serviceParam wikibase:language "[AUTO_LANGUAGE],'.concat(c.lang,'".\n    ?Pdescription rdfs:label ?').concat(c.description.label," . "),i="\nGROUP BY ?item ?label ?description ",c.properties.forEach(function(e,n){var t;!0===e.concat||!0===e.stopword?(t=e.delimiter?e.delimiter:" ",s+="(GROUP_CONCAT(DISTINCT ?"+e.label+'; SEPARATOR="'+"".concat(t)+'") AS ?'+e.label+") "):(s+="?".concat(e.label," "),i+="?".concat(e.label," ")),o+="\n  OPTIONAL{ ?item wdt:".concat(e.name," ?P").concat(e.label," . }"),r+="\n    ?P".concat(e.label," rdfs:label ?").concat(e.label," . ")}),r+="\n    ?item rdfs:label ?label . ",r+="\n  } ",n='WHERE {\n  SERVICE wikibase:mwapi {\n    bd:serviceParam wikibase:api "EntitySearch" .\n    bd:serviceParam wikibase:endpoint "www.wikidata.org" .\n    bd:serviceParam mwapi:search "'.concat(c.name,'" .\n    bd:serviceParam mwapi:language "').concat(c.lang,'" .\n    ?item wikibase:apiOutputItem mwapi:item .\n    ?num wikibase:apiOrdinal true .\n  }\n  ?item wdt:P31 wd:Q5. '),l=s+n+o+'\n  FILTER(LANG(?description) = "'+c.lang+'") '+r+"\n}"+i+"\nLIMIT "+c.limit,d(c.endpoint+encodeURIComponent(l),{json:!0,headers:{"User-Agent":"request"}},function(e,n,t){var i,r;if(e)return console.log(e);if(c.properties.forEach(function(e,n){if(!0===e.stopword)return b(t.results.bindings,e)}),!0===c.description.stopword&&b(t.results.bindings,c.description),!0===c.flatten){for(r in n=[],t.results.bindings)i={label:t.results.bindings[r].label.value,item:t.results.bindings[r].item.value},!0===c.unique?i.value=p(u(t.results.bindings[r])):i.value=u(t.results.bindings[r]),n.push(i);t.results=n}a({query:l,body:t})})},(e=process.argv.slice(2))[0])try{t(JSON.parse(e[0]),function(e){return!0===c.flatten?console.log(JSON.stringify(e.body.results)):console.log(JSON.stringify(e.body.results.bindings))})}catch(e){n=e,console.log([{msg:"Wrong input format.",error:n}])}return{retrieve:t}}(),module.exports=e}).call(void 0);
//# sourceMappingURL=crawl.js.map